# 🔍 OpenAI 公益站检测工具

一个用于测试 OpenAI 兼容接口功能的 Python 工具。可以帮助您快速检测公益站或第三方 API 是否支持各种 OpenAI 功能。

## ✨ 功能特性

- **📋 模型列表检测** - 获取并显示接口支持的所有模型
- **💬 基础对话检测** - 测试基本的 Chat Completion 功能
- **🌊 Stream 模式检测** - 测试接口是否支持流式输出
- **🔧 工具调用检测** - 测试接口是否支持 Function Calling / Tools
- **📊 Embeddings 检测** - 测试是否支持文本嵌入功能

## 📦 安装

### 1. 克隆或下载项目

```bash
cd /path/to/公益站测试
```

### 2. 安装依赖

```bash
pip install -r requirements.txt
```

或者手动安装：

```bash
pip install requests rich
```

## 🚀 使用方法

### 运行程序

```bash
python openai_tester.py
```

### 输入信息

程序会提示您输入：

1. **API Base URL** - API 的基础地址
   - 例如：`https://api.openai.com/v1`
   - 或公益站地址：`https://your-proxy.com/v1`

2. **API Key** - 您的 API 密钥

### 示例输出

```
╭─────────────────────────────────────╮
│ 🔍 OpenAI 公益站检测工具            │
│ 测试 OpenAI 兼容接口的各种功能      │
╰─────────────────────────────────────╯

请输入 API 信息:
API Base URL (如 https://api.openai.com/v1): https://api.example.com/v1
API Key: sk-xxxxx

开始测试...
==================================================

📋 测试模型列表...
┌────────────────────────────────┐
│       支持的模型列表           │
├──────┬─────────────────────────┤
│ 序号 │ 模型名称                │
├──────┼─────────────────────────┤
│ 1    │ gpt-3.5-turbo          │
│ 2    │ gpt-4                   │
│ ...  │ ...                     │
└──────┴─────────────────────────┘
✅ 成功获取 10 个模型

💬 测试基础对话...
✅ 对话成功
╭─────────── AI 回复 ───────────╮
│ 我是一个AI助手...             │
╰───────────────────────────────╯

🌊 测试 Stream 流式输出...
✅ Stream 模式支持! 收到 15 个数据块

🔧 测试工具调用 (Function Calling)...
✅ 工具调用支持!

📊 测试 Embeddings 文本嵌入...
✅ Embeddings 支持! 向量维度: 1536

╭─────────────────────────────────────╮
│         📊 测试结果摘要             │
╰─────────────────────────────────────╯
┌──────────────┬────────┬──────────┬─────────────┐
│ 测试项目     │ 状态   │ 响应时间 │ 备注        │
├──────────────┼────────┼──────────┼─────────────┤
│ 模型列表     │ ✅ 通过│ 0.5s     │ 10 个模型   │
│ 基础对话     │ ✅ 通过│ 1.2s     │ gpt-3.5-turbo│
│ Stream 模式  │ ✅ 通过│ 2.1s     │ 15 个数据块 │
│ 工具调用     │ ✅ 通过│ 1.8s     │ 已调用      │
│ Embeddings   │ ✅ 通过│ 0.3s     │ 1536 维向量 │
└──────────────┴────────┴──────────┴─────────────┘

总计: 5/5 项测试通过

测试完成!
```

## 📝 测试项目说明

| 测试项目 | 说明 |
|---------|------|
| 模型列表 | 调用 `/models` 接口获取支持的模型列表 |
| 基础对话 | 调用 `/chat/completions` 进行简单对话测试 |
| Stream 模式 | 测试流式输出，检查是否能正确接收 SSE 数据流 |
| 工具调用 | 测试 Function Calling 功能，发送带工具定义的请求 |
| Embeddings | 调用 `/embeddings` 接口测试文本嵌入功能 |

## ⚠️ 注意事项

1. 确保 API Base URL 格式正确，通常以 `/v1` 结尾
2. 某些公益站可能不支持所有功能，测试失败不代表接口完全不可用
3. 工具调用功能需要模型支持（如 GPT-3.5-turbo、GPT-4 等）
4. Embeddings 功能需要接口提供嵌入模型（如 text-embedding-ada-002）

## 🔧 自定义测试

您可以在代码中修改测试参数，例如：

```python
# 指定特定模型进行测试
tester.test_chat_completion(model="gpt-4")
tester.test_stream_mode(model="gpt-3.5-turbo")
```

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！
